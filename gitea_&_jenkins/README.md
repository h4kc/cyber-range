# Gitea and Jenkins Configuration!


## Run the containers

```sh
docker-compose up
```

## Check Gitea
IP_ADDRESS_SERVER:3000
## Check Jenkins 
IP_ADDRESS_SERVER:5000

If everything is running let's configure the  .

## Gitea Configuration

1-Create a user : username: cyber-range, password: cyber-range
2-Create a new repo : "cr-test-connection" 
3-Clone the repo to your host 
```sh
git clone [server_ip_adress]/cyber-range/cr-test-connection
```
4-Copy the sampleJenkinsFile content in a JenkinFiles
5-Push the changes to the repo 
```sh
git add JenkisFile
git commit -m "Add JenkinsFile"
git push
```
6-Add the ALLOWED_HOST_LIST in Gitea config file : 
when the docker-compose up command was executed a folder "gitea" was created. The "gitea" folder is mapped to the volume mounted by the container

```sh
nano ./gitea/gitea/gitea/conf/app.init
```
7-Add the following lines
```sh
[webhook]
ALLOWED_HOST_LIST = *
```
8-Add a Webhook to the repo : in the Gitea interface select the repo "cr-test-connection" go to settings>Webhooks>Add Webhook>Gitea
in the target url put the following url and save
```sh
http://[server_ip]:8080/gitea-webhook/post
```

## Configure Jenkins

1-Copy the password generated by Jenkins while running the docker-compose cmd
2-Go to the Jenkins interface and paste the given code
3-configure and install Jenkins
4-Install the gitea plugin
5-Go to Dashboard> Manage Jenkins > System
6-Scroll down to Gitea server and add a new server (URL + Credentials)
7-Enter "cr-test-connection" in the dashboard select new item , then select Pipline and press ok
8- In Build Trigger Don't Forget to select "Poll SCM" and let the schedule empty
9- Select , in Pipeline, "Pipeline Script from SCM", in SCM select: "git", set up the repo URL and credentials, and the branch name to *
10- Save, go to your IDE and try to execute a push to test the connection
